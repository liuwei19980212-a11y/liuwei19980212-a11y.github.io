<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ç”Ÿæ—¥å¿«ä¹ ğŸ‚</title>

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:linear-gradient(135deg,#ffe6ee,#f7f2ff);
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Helvetica Neue",Arial;
  color:#333;
  overflow:hidden;
}
.card{
  width:min(560px,90vw);
  background:#ffffffee;
  border-radius:24px;
  padding:28px 24px;
  text-align:center;
  box-shadow:0 20px 40px rgba(0,0,0,.08);
}
h1{ margin:0 0 12px; font-size:26px; }
p{ line-height:1.8; margin:12px 0; }
.from{ margin-top:14px; font-weight:500; }

button{
  margin-top:18px;
  padding:12px 26px;
  border:none;
  border-radius:999px;
  background:#ff6b9d;
  color:#fff;
  font-size:16px;
}
.secondary{
  background:#fff;
  color:#ff6b9d;
  border:1px solid rgba(255,107,157,.35);
}
.small{ font-size:14px; color:#666; margin-top:12px; }

#birthdayOnly{ display:none; margin-top:18px; }
#easterEgg{ display:none; margin-top:14px; font-size:14px; color:#888; }

.heart{
  position:fixed;
  font-size:22px;
  animation:float 2s ease-out forwards;
}
@keyframes float{
  from{opacity:1;transform:translateY(0)}
  to{opacity:0;transform:translateY(-120px)}
}

.musicBox{
  margin-top:16px;
  padding-top:10px;
  border-top:1px dashed rgba(0,0,0,.08);
}
.tip2{ margin-top:8px; font-size:12px; color:#999; }
</style>
</head>

<body>
<div class="card">
  <div style="font-size:42px">ğŸ‚</div>
  <h1><span style="color:#ff6b9d">å¼ æ–‡é™</span>ï¼Œç”Ÿæ—¥å¿«ä¹</h1>

  <p>
    æ„¿ä½ æ–°çš„ä¸€å²ï¼Œ<br>
    æœ‰çƒ­çˆ±ï¼Œæœ‰æœŸå¾…ï¼Œ<br>
    æœ‰äººæƒ¦è®°ï¼Œ<br>
    ä¹Ÿè¢«ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ã€‚
  </p>

  <p class="from">â€”â€” æ¥è‡ª <span style="color:#ff6b9d">åˆ˜ä¼Ÿ</span></p>

  <button id="fireBtn">ç‚¹æˆ‘ä¸€ä¸‹ ğŸ¤</button>
  <p id="countdown" class="small"></p>

  <div id="birthdayOnly">
    <p>
      ğŸ‚ ä»Šå¤©æ˜¯ä½ çš„ç”Ÿæ—¥<br>
      æœ‰äº›è¯å¹³æ—¶ä¸è¯´ï¼Œ<br>
      ä½†ä»Šå¤©å¯ä»¥ã€‚
    </p>
    <p><b>ä½ çœŸçš„ï¼Œå¾ˆå€¼å¾—è¢«è®¤çœŸå¯¹å¾…ã€‚</b></p>
  </div>

  <p id="easterEgg">è¿™å¥è¯ï¼Œæœ¬æ¥æ²¡æ‰“ç®—ç»™ä»»ä½•äººçœ‹ã€‚</p>

  <!-- å¥¹æ¨èçš„æ­Œï¼šç›´æ¥å°è¯•æ‰“å¼€ QQéŸ³ä¹ App -->
  <div class="musicBox">
    <p class="small" style="margin-bottom:6px;">ğŸ§ æˆ‘ä¹Ÿå»å¬äº†ä½ æ¨èçš„æ­Œï¼š</p>
    <p style="margin:6px 0;"><b>NOT CUTE ANYMORE</b> Â· ILLIT</p>
    <button class="secondary" id="openAppBtn">å» QQéŸ³ä¹ App å¬</button>
    <div class="tip2" id="appTip" style="display:none;">
      å·²å¤åˆ¶æ­Œååˆ°å‰ªè´´æ¿ï¼šæ‰“å¼€QQéŸ³ä¹åç›´æ¥ç²˜è´´æœç´¢å°±è¡Œï½
    </div>
    <div class="tip2" id="fallbackTip" style="display:none;">
      å¦‚æœæ²¡èƒ½å”¤èµ· Appï¼Œä¼šè‡ªåŠ¨æ‰“å¼€ç½‘é¡µæœç´¢ï¼ˆå¾®ä¿¡é‡Œå»ºè®®ç”¨ Safari æ‰“å¼€å†è¯•ï¼‰ã€‚
    </div>
  </div>
</div>

<audio id="music" loop playsinline preload="auto">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_7c2b2b89f7.mp3" type="audio/mpeg">
</audio>

<script>
const btn = document.getElementById("fireBtn");
const music = document.getElementById("music");

const today = new Date();
const birthday = new Date(today.getFullYear(),0,14);
const isBirthday = (today.getMonth()===0 && today.getDate()===14);

if(today>birthday) birthday.setFullYear(today.getFullYear()+1);
const diff = Math.ceil((birthday - today)/(1000*60*60*24));

document.getElementById("countdown").innerText =
  isBirthday ? "ğŸˆ ä»Šå¤©æ˜¯ä½ çš„ç”Ÿæ—¥" : `ğŸˆ è·ç¦»ç”Ÿæ—¥è¿˜æœ‰ ${diff} å¤©`;

if(isBirthday){
  document.getElementById("birthdayOnly").style.display="block";
}

btn.addEventListener("click",()=>{
  music.play().catch(()=>{});
  for(let i=0;i<10;i++){
    const h=document.createElement("div");
    h.className="heart";
    h.innerText = (Math.random()>0.6) ? "ğŸ†" : "ğŸ’–";
    h.style.left=Math.random()*100+"vw";
    h.style.bottom="0";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),2000);
  }
  if(isBirthday){
    document.getElementById("easterEgg").style.display="block";
  }
});

// ====== ç›´æ¥å”¤èµ· Appï¼ˆQQéŸ³ä¹ï¼‰ ======
const SONG_NAME = "NOT CUTE ANYMORE";
const ARTIST = "ILLIT";
const QUERY = `${SONG_NAME} ${ARTIST}`;

const openAppBtn = document.getElementById("openAppBtn");
const appTip = document.getElementById("appTip");
const fallbackTip = document.getElementById("fallbackTip");

// ç½‘é¡µå…œåº•ï¼ˆæ²¡è£…App/è¢«æ‹¦æˆªæ—¶ï¼‰
const QQ_WEB_SEARCH = `https://y.qq.com/n/ryqq/search?w=${encodeURIComponent(QUERY)}`;

// åªç”¨â€œæ‰“å¼€ Appâ€æœ€ç¨³çš„æ–¹æ¡ˆï¼šå…ˆå¤åˆ¶ï¼Œå†å°è¯•å”¤èµ·
async function copyText(text){
  try{
    await navigator.clipboard.writeText(text);
    return true;
  }catch(e){
    const ta=document.createElement("textarea");
    ta.value=text;
    document.body.appendChild(ta);
    ta.select();
    let ok=false;
    try{ ok=document.execCommand("copy"); }catch(_){}
    ta.remove();
    return ok;
  }
}

openAppBtn.addEventListener("click", async ()=>{
  appTip.style.display="none";
  fallbackTip.style.display="none";

  const ok = await copyText(QUERY);
  if(ok) appTip.style.display="block";

  // å°è¯•å”¤èµ· QQéŸ³ä¹ Appï¼ˆè‹¥å®‰è£…ä¼šå¼¹â€œæ‰“å¼€QQéŸ³ä¹â€ï¼‰
  // æ³¨æ„ï¼šå¾®ä¿¡å†…ç½®æµè§ˆå™¨å¯èƒ½æ‹¦æˆª
  location.href = "qqmusic://";

  // å…œåº•ï¼šå¦‚æœæ²¡å”¤èµ·ï¼Œç¨åæ‰“å¼€ç½‘é¡µæœç´¢
  fallbackTip.style.display="block";
  setTimeout(()=>{ location.href = QQ_WEB_SEARCH; }, 900);
});
</script>
</body>
</html>
